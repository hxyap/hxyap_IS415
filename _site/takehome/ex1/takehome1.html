<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yap Hong Xian">
<meta name="dcterms.date" content="2024-09-02">

<title>hxyap - Takehome 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">hxyap</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-exercises">    
        <li>
    <a class="dropdown-item" href="../../exercises/ex1/ex1.html">
 <span class="dropdown-text">ex1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../exercises/ex2/ex2.html">
 <span class="dropdown-text">ex2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../exercises/ex3/ex3.html">
 <span class="dropdown-text">ex3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../exercises/ex5/ex5.html">
 <span class="dropdown-text">ex5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../exercises/ex6/ex6.html">
 <span class="dropdown-text">ex6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/ICE-1/ice1.html">
 <span class="dropdown-text">ex1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/ICE-2/ice2.html">
 <span class="dropdown-text">ex2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/ICE-3/ice3.html">
 <span class="dropdown-text">ex3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/ICE-4/ice4.html">
 <span class="dropdown-text">ex4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/ICE-5/ice4.html">
 <span class="dropdown-text">ex5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-takehomes" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">takehomes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-takehomes">    
        <li>
    <a class="dropdown-item" href="../../takehome/ex1/takehome1.html">
 <span class="dropdown-text">ex1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Hong Xian’s IS415 Geospatial Analytics and Applications portfolio</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-armed-conflict-in-myanmar" id="toc-introduction-armed-conflict-in-myanmar" class="nav-link active" data-scroll-target="#introduction-armed-conflict-in-myanmar">Introduction: Armed Conflict in Myanmar</a>
  <ul class="collapse">
  <li><a href="#historical-context" id="toc-historical-context" class="nav-link" data-scroll-target="#historical-context">Historical Context</a></li>
  <li><a href="#key-factors-in-myanmars-conflicts" id="toc-key-factors-in-myanmars-conflicts" class="nav-link" data-scroll-target="#key-factors-in-myanmars-conflicts">Key Factors in Myanmar’s Conflicts</a></li>
  <li><a href="#purpose-of-the-analysis" id="toc-purpose-of-the-analysis" class="nav-link" data-scroll-target="#purpose-of-the-analysis">Purpose of the Analysis</a></li>
  </ul></li>
  <li><a href="#compare-crs" id="toc-compare-crs" class="nav-link" data-scroll-target="#compare-crs">Compare CRS</a></li>
  <li><a href="#defining-our-kde-function-and-ppp" id="toc-defining-our-kde-function-and-ppp" class="nav-link" data-scroll-target="#defining-our-kde-function-and-ppp">Defining our KDE function, and ppp</a>
  <ul class="collapse">
  <li><a href="#plotting-armed-events-owin" id="toc-plotting-armed-events-owin" class="nav-link" data-scroll-target="#plotting-armed-events-owin">Plotting Armed events owin:</a>
  <ul class="collapse">
  <li><a href="#plotting-stkde-for-quarterly-kde" id="toc-plotting-stkde-for-quarterly-kde" class="nav-link" data-scroll-target="#plotting-stkde-for-quarterly-kde">Plotting stkde for quarterly kde</a></li>
  </ul></li>
  <li><a href="#quarterly-kde" id="toc-quarterly-kde" class="nav-link" data-scroll-target="#quarterly-kde">Quarterly KDE</a></li>
  <li><a href="#quarterly-spatiotemporal-kde" id="toc-quarterly-spatiotemporal-kde" class="nav-link" data-scroll-target="#quarterly-spatiotemporal-kde">Quarterly spatiotemporal KDE</a></li>
  <li><a href="#second-order-analysis" id="toc-second-order-analysis" class="nav-link" data-scroll-target="#second-order-analysis">Second order analysis</a>
  <ul class="collapse">
  <li><a href="#mandalay-analysis" id="toc-mandalay-analysis" class="nav-link" data-scroll-target="#mandalay-analysis">Mandalay analysis</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#visualization-of-conflict-density-using-openstreetmap" id="toc-visualization-of-conflict-density-using-openstreetmap" class="nav-link" data-scroll-target="#visualization-of-conflict-density-using-openstreetmap">Visualization of Conflict Density Using OpenStreetMap</a></li>
  <li><a href="#bonus-section-network-analysis" id="toc-bonus-section-network-analysis" class="nav-link" data-scroll-target="#bonus-section-network-analysis">Bonus section: Network analysis</a></li>
  <li><a href="#network-graph-of-actor-interactions" id="toc-network-graph-of-actor-interactions" class="nav-link" data-scroll-target="#network-graph-of-actor-interactions">Network Graph of Actor Interactions</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a>
  <ul class="collapse">
  <li><a href="#acknowledgementsreferences" id="toc-acknowledgementsreferences" class="nav-link" data-scroll-target="#acknowledgementsreferences">Acknowledgements/references</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Takehome 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yap Hong Xian </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 2, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">September 2, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"maptools"</span>, <span class="at">repos =</span> <span class="st">"https://packagemanager.posit.co/cran/2023-10-13"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into 'C:/Users/yapho/AppData/Local/R/win-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>package 'maptools' successfully unpacked and MD5 sums checked</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: cannot remove prior installation of package 'maptools'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in file.copy(savedcopy, lib, recursive = TRUE): problem copying
C:\Users\yapho\AppData\Local\R\win-library\4.4\00LOCK\maptools\libs\x64\maptools.dll
to
C:\Users\yapho\AppData\Local\R\win-library\4.4\maptools\libs\x64\maptools.dll:
Permission denied</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: restored 'maptools'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    C:\Users\yapho\AppData\Local\Temp\RtmpUz3o2l\downloaded_packages</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, raster, spatstat, tmap, tidyverse, viridis, classInt, maptools, OpenStreetMap, stars, spdep, prophet, tmaptools, sparr, igraph, ggraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction-armed-conflict-in-myanmar" class="level1">
<h1>Introduction: Armed Conflict in Myanmar</h1>
<p>Myanmar, formerly known as Burma, is a country in Southeast Asia with a rich cultural heritage and a complex, often troubled modern history. With a population of about 54 million people and over 135 distinct ethnic groups, Myanmar is a tapestry of diverse cultures, languages, and traditions. However, this diversity has also been a source of long-standing tensions and conflicts.</p>
<section id="historical-context" class="level2">
<h2 class="anchored" data-anchor-id="historical-context">Historical Context</h2>
<p>Since gaining independence from British rule in 1948, Myanmar has grappled with numerous internal conflicts. For decades, the country was under military rule, which ended officially in 2011 with a transition to a quasi-civilian government. However, in February 2021, the military (Tatmadaw) seized power again in a coup, plunging the country back into political turmoil and reigniting many dormant conflicts.</p>
</section>
<section id="key-factors-in-myanmars-conflicts" class="level2">
<h2 class="anchored" data-anchor-id="key-factors-in-myanmars-conflicts">Key Factors in Myanmar’s Conflicts</h2>
<p>Our analysis of armed conflict in Myanmar focuses on three primary factors that have historically been, and continue to be, major drivers of instability:</p>
<p>1. <strong>Religious Tensions</strong>: Myanmar is predominantly Buddhist, but with significant Muslim, Christian, and animist minorities. Religious tensions, particularly between Buddhists and Muslims, have led to violent conflicts, most notably the persecution of the Rohingya Muslim minority in Rakhine State.</p>
<p>2. <strong>Ethnic Tensions</strong>: The country’s ethnic diversity has been a source of both cultural richness and conflict. Many ethnic minority groups, particularly in border areas, have long sought greater autonomy or independence from the central government dominated by the Bamar majority. These tensions have resulted in some of the world’s longest-running civil wars.</p>
<p>3. <strong>Drug Trade and Infrastructure Development</strong>: Myanmar is part of the Golden Triangle, one of the world’s largest drug-producing regions. The drug trade, particularly methamphetamine and opium, has fueled conflicts and corrupted institutions. Simultaneously, infrastructure development projects, often involving foreign investment, have sometimes exacerbated local tensions over land rights and resource allocation.</p>
</section>
<section id="purpose-of-the-analysis" class="level2">
<h2 class="anchored" data-anchor-id="purpose-of-the-analysis">Purpose of the Analysis</h2>
<p>Given this complex backdrop, our geospatial analysis of armed conflict in Myanmar aims to:</p>
<p>1. Identify patterns and hotspots of armed conflict.</p>
<p>2. Examine how these factors interact and potentially exacerbate each other in different regions of the country.</p>
<p>3. Track changes in conflict patterns over time, particularly in relation to significant political events like the 2021 military coup.</p>
<p>By focusing on these aspects, we hope to provide valuable insights that can inform humanitarian responses, contribute to a better understanding of conflict dynamics, and assist in developing more effective strategies for peace-building and development in the region.</p>
<p>We first begin by using read_csv to read our aspatial csv data into our sf frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>acled_sf <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/ACLED_Myanmar.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">32647</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">event_date =</span> <span class="fu">dmy</span>(event_date))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 55574 Columns: 31
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...
dbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Now that we’ve load the sf, let’s check if our boundary for Myanmar works:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>acled_sf <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2023</span> <span class="sc">|</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>           event_type <span class="sc">==</span> <span class="st">"Political violence"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We’ll next use glimpse so we know what aspects of the data we can work around to try to glean more insights about the Myanmar crisis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(acled_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 55,574
Columns: 30
$ event_id_cnty      &lt;chr&gt; "MMR56099", "MMR56222", "MMR56370", "MMR56376", "MM…
$ event_date         &lt;date&gt; 2023-12-31, 2023-12-31, 2023-12-31, 2023-12-31, 20…
$ year               &lt;dbl&gt; 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 202…
$ time_precision     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ disorder_type      &lt;chr&gt; "Political violence", "Political violence", "Politi…
$ event_type         &lt;chr&gt; "Explosions/Remote violence", "Explosions/Remote vi…
$ sub_event_type     &lt;chr&gt; "Shelling/artillery/missile attack", "Shelling/arti…
$ actor1             &lt;chr&gt; "Military Forces of Myanmar (2021-)", "Military For…
$ assoc_actor_1      &lt;chr&gt; NA, NA, NA, NA, NA, NA, "Daw Na Column; YGF: Ye Gue…
$ inter1             &lt;dbl&gt; 1, 1, 3, 6, 1, 1, 3, 1, 2, 1, 1, 2, 2, 1, 1, 3, 3, …
$ actor2             &lt;chr&gt; NA, "Civilians (Myanmar)", "Military Forces of Myan…
$ assoc_actor_2      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ inter2             &lt;dbl&gt; 0, 7, 1, 0, 7, 0, 1, 0, 1, 7, 7, 1, 1, 0, 0, 1, 1, …
$ interaction        &lt;dbl&gt; 10, 17, 13, 60, 17, 10, 13, 10, 12, 17, 17, 12, 12,…
$ civilian_targeting &lt;chr&gt; NA, "Civilian targeting", NA, NA, NA, NA, NA, NA, N…
$ iso                &lt;dbl&gt; 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 1…
$ region             &lt;chr&gt; "Southeast Asia", "Southeast Asia", "Southeast Asia…
$ country            &lt;chr&gt; "Myanmar", "Myanmar", "Myanmar", "Myanmar", "Myanma…
$ admin1             &lt;chr&gt; "Mon", "Rakhine", "Bago-West", "Sagaing", "Bago-Wes…
$ admin2             &lt;chr&gt; "Mawlamyine", "Maungdaw", "Thayarwady", "Yinmarbin"…
$ admin3             &lt;chr&gt; "Ye", "Maungdaw", "Nattalin", "Salingyi", "Nattalin…
$ location           &lt;chr&gt; "Aing Shey", "Kaing Gyi (NaTaLa)", "Kyauk Pyoke", "…
$ geo_precision      &lt;dbl&gt; 1, 2, 2, 2, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2, …
$ source             &lt;chr&gt; "Democratic Voice of Burma", "Development Media Gro…
$ source_scale       &lt;chr&gt; "National", "Subnational", "National", "National", …
$ notes              &lt;chr&gt; "On 31 December 2023, in Aing Shey village (Ye town…
$ fatalities         &lt;dbl&gt; 0, 0, 4, 0, 0, 0, 3, 0, 0, 0, 1, 0, 0, 0, 0, 1, 2, …
$ tags               &lt;chr&gt; NA, NA, NA, "crowd size=no report", NA, NA, NA, NA,…
$ timestamp          &lt;dbl&gt; 1704831212, 1704831213, 1704831214, 1704831214, 170…
$ geometry           &lt;POINT [m]&gt; POINT (393190.2 1690159), POINT (-183852.6 23…</code></pre>
</div>
</div>
<p>For later analysis, we’ll also be using the regional boundaries as well, so I’ve conveniently placed this chunk below to load our regional boundaries.</p>
<p>Let’s load our boundary:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>myanmar_boundary_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/mmr_polbnda_adm0_250k_mimu_1"</span>, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"mmr_polbnda_adm0_250k_mimu_1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `mmr_polbnda_adm0_250k_mimu_1' from data source 
  `C:\Users\yapho\Documents\SMU\smu y4\is415\hxyap_IS415\takehome\ex1\data\mmr_polbnda_adm0_250k_mimu_1' 
  using driver `ESRI Shapefile'
Simple feature collection with 1 feature and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</section>
</section>
<section id="compare-crs" class="level1">
<h1>Compare CRS</h1>
<p>Since we’ve gotten our data from different sources, let’s find out if they follow Myanmar’s crs system to ensure consistency for our analysis!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check CRS of acled_sf</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print("CRS of ACLED data:")</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print(st_crs(acled_sf))</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># WGS84</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hmm… this might differ from the boundaries of the Myanmar boundary. Let’s do a quick st_transform to change the CRS used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform Myanmar boundary to match ACLED data CRS</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>myanmar_boundary_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(myanmar_boundary_sf, <span class="fu">st_crs</span>(acled_sf))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Unite all geometries</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>myanmar_boundary_sf <span class="ot">&lt;-</span> <span class="fu">st_union</span>(myanmar_boundary_sf)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove Z or M dimensions</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>myanmar_boundary_sf <span class="ot">&lt;-</span> <span class="fu">st_zm</span>(myanmar_boundary_sf, <span class="at">drop =</span> <span class="cn">TRUE</span>, <span class="at">what =</span> <span class="st">"ZM"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print(st_crs(myanmar_boundary_sf))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that our data is formatted in the same way, we can start slowly plotting our boundary to do our initial analysis of the conflict!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a simple plot of the Myanmar boundary</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(myanmar_boundary_sf) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Myanmar Boundary"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">title.position =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"top"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s check if our event types exist as defined:</p>
<p>Here we check for unique events to ensure we are capturing the correct event types:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>unique_event_types <span class="ot">&lt;-</span> <span class="fu">unique</span>(acled_sf<span class="sc">$</span>event_type)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unique event types in the dataset:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unique event types in the dataset:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(unique_event_types)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Explosions/Remote violence" "Battles"                   
[3] "Protests"                   "Strategic developments"    
[5] "Violence against civilians" "Riots"                     </code></pre>
</div>
</div>
<p>Sweet! looks good! Let’s filter out now for our wanted event types!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter ACLED data for the specified date range and event types</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>event_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Battles"</span>, <span class="st">"Explosions/Remote violence"</span>, <span class="st">"Strategic developments"</span>, <span class="st">"Violence against civilians"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>acled_filtered <span class="ot">&lt;-</span> acled_sf <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(event_date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2021-01-01"</span>) <span class="sc">&amp;</span> event_date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2024-06-30"</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>         event_type <span class="sc">%in%</span> event_types) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">quarter =</span> <span class="fu">paste0</span>(<span class="fu">year</span>(event_date), <span class="st">"_Q"</span>, <span class="fu">quarter</span>(event_date)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="defining-our-kde-function-and-ppp" class="level1">
<h1>Defining our KDE function, and ppp</h1>
<p>To gain a better understanding of where we should look at to find the hotspot of the conflict, we should use KDE here to visualize the “hot-cold” spots on the map, where redder points have more conflict and “colder” bluer points have less. Furthermore, KDE also smoothes out the data, making it easier to visualize on the map where we should pay attention to.</p>
<p>We’ll first convert to ppp (planar point pattern) so we can do use it for our KDE analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create window for ppp objects</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>myanmar_window <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(myanmar_boundary_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, we create the quarter column in order to break down the conflict into distinct time bounded quarters. This will come in handy later should we choose to do snapshots at every quarter to visualize how conflict has evolved in Myanmar over time, as well as facilitating temporal analysis. Note that we are using numeric quarters here since it makes it easier later on for us to plot spatiotemporal KDE!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Quarter column</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>acled_filtered<span class="sc">$</span>Quarter <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">year</span>(acled_filtered<span class="sc">$</span>event_date), <span class="st">"_Q"</span>, <span class="fu">quarter</span>(acled_filtered<span class="sc">$</span>event_date))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#numeric (1-12)</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>acled_filtered<span class="sc">$</span>QuarterNumeric <span class="ot">&lt;-</span> (<span class="fu">year</span>(acled_filtered<span class="sc">$</span>event_date) <span class="sc">-</span> <span class="dv">2021</span>) <span class="sc">*</span> <span class="dv">4</span> <span class="sc">+</span> <span class="fu">quarter</span>(acled_filtered<span class="sc">$</span>event_date)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new sf object with only Quarter and geometry</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>acled_quarter <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">QuarterNumeric =</span> acled_filtered<span class="sc">$</span>QuarterNumeric,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">geometry =</span> <span class="fu">st_geometry</span>(acled_filtered)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>acled_quarter_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(acled_quarter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In order to avoid duplicated data point on the same location messing with our analysis, we separate them via jittering as below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply jittering</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>acled_q_ppp_jit <span class="ot">&lt;-</span> <span class="fu">rjitter</span>(acled_quarter_ppp, <span class="at">retry=</span><span class="cn">TRUE</span>, <span class="at">nsim=</span><span class="dv">1</span>, <span class="at">drop=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">duplicated</span>(acled_q_ppp_jit))) {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"Some duplicates remain after jittering"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we segragate the data into our previous Myanmar boundary window so we ensure everything can be plotted within the borders of Myanmar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>armed_q_owin <span class="ot">&lt;-</span> acled_q_ppp_jit[myanmar_window]</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(armed_q_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern:  35606 points
Average intensity 5.316602e-08 points per square unit

Coordinates are given to 16 decimal places

marks are numeric, of type 'double'
Summary:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   4.000   7.000   6.838  10.000  12.000 

Window: polygonal boundary
563 separate polygons (3 holes)
                   vertices         area relative.area
polygon 1             37581  6.60254e+11      9.86e-01
polygon 2                26  2.85778e+06      4.27e-06
polygon 3                43  7.32477e+06      1.09e-05
polygon 4               103  1.86991e+07      2.79e-05
polygon 5                37  9.32316e+06      1.39e-05
polygon 6               371  2.43869e+08      3.64e-04
polygon 7               297  2.84905e+08      4.25e-04
polygon 8                33  1.68222e+07      2.51e-05
polygon 9                33  4.47665e+05      6.68e-07
polygon 10               19  1.34593e+05      2.01e-07
polygon 11               39  1.36327e+06      2.04e-06
polygon 12              137  1.55547e+08      2.32e-04
polygon 13               36  8.76479e+06      1.31e-05
polygon 14               79  3.08116e+07      4.60e-05
polygon 15              388  2.25271e+08      3.36e-04
polygon 16              316  7.78512e+07      1.16e-04
polygon 17               13  1.09564e+05      1.64e-07
polygon 18               18  3.49727e+05      5.22e-07
polygon 19               31  1.23017e+06      1.84e-06
polygon 20               16  6.55537e+05      9.79e-07
polygon 21               24  8.49487e+05      1.27e-06
polygon 22               30  2.54436e+06      3.80e-06
polygon 23              336  4.15806e+07      6.21e-05
polygon 24              330  1.69190e+08      2.53e-04
polygon 25               47  1.08035e+07      1.61e-05
polygon 26               39  4.94369e+06      7.38e-06
polygon 27               23  2.72438e+06      4.07e-06
polygon 28               33  5.70263e+06      8.52e-06
polygon 29               90  4.20329e+07      6.28e-05
polygon 30               28  1.35341e+06      2.02e-06
polygon 31              225  1.08816e+08      1.62e-04
polygon 32               33  9.16670e+06      1.37e-05
polygon 33              192  7.02655e+07      1.05e-04
polygon 34               49  1.49245e+07      2.23e-05
polygon 35               98  1.79076e+07      2.67e-05
polygon 36                6  6.37552e+05      9.52e-07
polygon 37               49  1.01233e+07      1.51e-05
polygon 38              141  3.43053e+07      5.12e-05
polygon 39              195  3.24345e+07      4.84e-05
polygon 40               51  3.38313e+06      5.05e-06
polygon 41               34  2.01400e+06      3.01e-06
polygon 42               13  2.50435e+05      3.74e-07
polygon 43                9  9.04824e+04      1.35e-07
polygon 44               34  4.61794e+06      6.90e-06
polygon 45               17  4.58200e+05      6.84e-07
polygon 46               15  2.74776e+05      4.10e-07
polygon 47               21  5.34978e+05      7.99e-07
polygon 48               19  4.55347e+05      6.80e-07
polygon 49               71  3.42557e+06      5.11e-06
polygon 50               24  1.32420e+06      1.98e-06
polygon 51               15  3.26247e+05      4.87e-07
polygon 52               39  8.65790e+05      1.29e-06
polygon 53               43  1.41627e+06      2.11e-06
polygon 54               24  7.52068e+05      1.12e-06
polygon 55               96  1.32101e+07      1.97e-05
polygon 56               38  1.18003e+06      1.76e-06
polygon 57              429  5.99087e+08      8.95e-04
polygon 58               13  1.74105e+05      2.60e-07
polygon 59               19  2.52336e+05      3.77e-07
polygon 60               16  3.11495e+05      4.65e-07
polygon 61               11  9.11047e+04      1.36e-07
polygon 62               12  2.13470e+05      3.19e-07
polygon 63               17  5.82663e+05      8.70e-07
polygon 64               56  2.60440e+07      3.89e-05
polygon 65              107  4.91389e+06      7.34e-06
polygon 66               51  2.79076e+06      4.17e-06
polygon 67               89  1.61156e+07      2.41e-05
polygon 68               28  1.30499e+06      1.95e-06
polygon 69               11  1.27616e+05      1.91e-07
polygon 70               34  2.54199e+06      3.80e-06
polygon 71               27  1.72476e+06      2.58e-06
polygon 72               37  2.01882e+06      3.01e-06
polygon 73               23  1.65571e+06      2.47e-06
polygon 74               33  3.05816e+06      4.57e-06
polygon 75               14  3.23153e+05      4.83e-07
polygon 76               91  1.51209e+07      2.26e-05
polygon 77               12  2.42901e+05      3.63e-07
polygon 78               11  1.37889e+05      2.06e-07
polygon 79               58  2.29751e+07      3.43e-05
polygon 80               48  5.10265e+06      7.62e-06
polygon 81               22  1.30706e+06      1.95e-06
polygon 82               15  3.49480e+05      5.22e-07
polygon 83               17  1.57570e+06      2.35e-06
polygon 84               34  3.68725e+06      5.51e-06
polygon 85               34  5.21904e+06      7.79e-06
polygon 86               24  5.42734e+06      8.10e-06
polygon 87              422  4.66497e+08      6.97e-04
polygon 88              142  2.98767e+07      4.46e-05
polygon 89              132  2.18707e+07      3.27e-05
polygon 90               19  5.88230e+05      8.78e-07
polygon 91               22  1.77611e+06      2.65e-06
polygon 92               40  4.09952e+06      6.12e-06
polygon 93               28  1.47685e+06      2.21e-06
polygon 94               67  9.99685e+06      1.49e-05
polygon 95               25  4.82266e+05      7.20e-07
polygon 96               16  4.14093e+05      6.18e-07
polygon 97               26  3.03928e+06      4.54e-06
polygon 98               14  1.53563e+05      2.29e-07
polygon 99               19  5.08538e+05      7.59e-07
polygon 100              16  1.80565e+05      2.70e-07
polygon 101              26  9.75091e+05      1.46e-06
polygon 102              19  2.15295e+05      3.21e-07
polygon 103              16  3.50061e+05      5.23e-07
polygon 104 (hole)        3 -1.78834e+02     -2.67e-10
polygon 105              14  2.11571e+05      3.16e-07
polygon 106              11  1.59536e+05      2.38e-07
polygon 107             111  7.35028e+07      1.10e-04
polygon 108              54  9.35305e+06      1.40e-05
polygon 109              19  6.34649e+05      9.48e-07
polygon 110              79  1.47390e+07      2.20e-05
polygon 111              10  3.74827e+04      5.60e-08
polygon 112              13  1.37100e+05      2.05e-07
polygon 113              31  4.47193e+06      6.68e-06
polygon 114              19  1.23742e+06      1.85e-06
polygon 115              20  1.79201e+06      2.68e-06
polygon 116              16  2.19464e+05      3.28e-07
polygon 117              11  7.94092e+04      1.19e-07
polygon 118              14  1.45779e+05      2.18e-07
polygon 119              31  6.24672e+05      9.33e-07
polygon 120              11  2.29288e+04      3.42e-08
polygon 121              18  2.10998e+05      3.15e-07
polygon 122              26  2.52571e+06      3.77e-06
polygon 123              16  5.77783e+05      8.63e-07
polygon 124              26  8.87985e+05      1.33e-06
polygon 125              13  1.10557e+05      1.65e-07
polygon 126              21  9.55338e+05      1.43e-06
polygon 127              32  2.18189e+06      3.26e-06
polygon 128              18  7.64830e+05      1.14e-06
polygon 129              34  1.71336e+06      2.56e-06
polygon 130             115  9.29594e+05      1.39e-06
polygon 131              68  2.06761e+05      3.09e-07
polygon 132              40  4.87851e+06      7.28e-06
polygon 133              10  7.43137e+04      1.11e-07
polygon 134              17  5.95020e+05      8.88e-07
polygon 135              21  4.02132e+05      6.00e-07
polygon 136              21  1.09635e+06      1.64e-06
polygon 137              14  1.15356e+05      1.72e-07
polygon 138              20  3.13610e+05      4.68e-07
polygon 139             275  3.92648e+08      5.86e-04
polygon 140              16  2.19612e+05      3.28e-07
polygon 141              13  2.64858e+05      3.95e-07
polygon 142              23  1.25549e+06      1.87e-06
polygon 143               9  1.79312e+05      2.68e-07
polygon 144              15  2.93132e+05      4.38e-07
polygon 145              15  5.29892e+05      7.91e-07
polygon 146              23  4.95351e+05      7.40e-07
polygon 147              14  4.41976e+05      6.60e-07
polygon 148              19  3.32318e+05      4.96e-07
polygon 149              16  4.15914e+05      6.21e-07
polygon 150              22  5.10526e+05      7.62e-07
polygon 151              48  1.87148e+07      2.79e-05
polygon 152              18  1.62882e+06      2.43e-06
polygon 153              71  2.43615e+07      3.64e-05
polygon 154             116  5.16444e+07      7.71e-05
polygon 155              19  1.54144e+06      2.30e-06
polygon 156              11  2.01013e+05      3.00e-07
polygon 157              20  2.31201e+06      3.45e-06
polygon 158              15  5.94674e+05      8.88e-07
polygon 159             218  1.56252e+08      2.33e-04
polygon 160             162  8.80247e+07      1.31e-04
polygon 161              16  3.69968e+05      5.52e-07
polygon 162              14  1.61451e+05      2.41e-07
polygon 163              18  5.54566e+05      8.28e-07
polygon 164              19  5.07078e+05      7.57e-07
polygon 165              57  6.86475e+06      1.03e-05
polygon 166              15  6.56018e+05      9.80e-07
polygon 167              21  6.65092e+05      9.93e-07
polygon 168              15  5.97784e+05      8.93e-07
polygon 169              37  2.56010e+06      3.82e-06
polygon 170              13  1.66996e+05      2.49e-07
polygon 171              20  8.18381e+05      1.22e-06
polygon 172              21  2.89704e+06      4.33e-06
polygon 173              15  4.08213e+05      6.10e-07
polygon 174             104  4.71547e+07      7.04e-05
polygon 175              28  3.80443e+06      5.68e-06
polygon 176              67  3.17343e+07      4.74e-05
polygon 177             730  9.20735e+08      1.37e-03
polygon 178              16  2.01576e+05      3.01e-07
polygon 179              12  1.41506e+05      2.11e-07
polygon 180              15  4.92125e+05      7.35e-07
polygon 181              18  1.58128e+06      2.36e-06
polygon 182              25  1.94322e+06      2.90e-06
polygon 183              12  2.51373e+05      3.75e-07
polygon 184             412  4.47936e+08      6.69e-04
polygon 185              22  7.57105e+05      1.13e-06
polygon 186              16  6.97434e+05      1.04e-06
polygon 187              39  4.45130e+06      6.65e-06
polygon 188              13  8.83786e+05      1.32e-06
polygon 189              10  2.06200e+05      3.08e-07
polygon 190              76  3.60497e+07      5.38e-05
polygon 191              13  4.56433e+05      6.82e-07
polygon 192              28  2.30613e+06      3.44e-06
polygon 193              27  2.50338e+06      3.74e-06
polygon 194              14  4.69238e+05      7.01e-07
polygon 195              10  1.69886e+05      2.54e-07
polygon 196              16  5.42822e+05      8.11e-07
polygon 197              10  1.17633e+05      1.76e-07
polygon 198               8  7.08579e+04      1.06e-07
polygon 199             144  7.85300e+07      1.17e-04
polygon 200              37  1.93477e+06      2.89e-06
polygon 201              25  5.59996e+05      8.36e-07
polygon 202              44  2.86031e+06      4.27e-06
polygon 203              26  1.26276e+06      1.89e-06
polygon 204             149  1.37840e+08      2.06e-04
polygon 205              18  4.84958e+05      7.24e-07
polygon 206              73  2.93195e+07      4.38e-05
polygon 207              45  6.87481e+06      1.03e-05
polygon 208              64  1.80880e+07      2.70e-05
polygon 209              12  8.76879e+05      1.31e-06
polygon 210              26  2.78381e+06      4.16e-06
polygon 211              35  8.72326e+06      1.30e-05
polygon 212              53  1.06237e+07      1.59e-05
polygon 213              26  5.40467e+06      8.07e-06
polygon 214             148  1.05037e+08      1.57e-04
polygon 215              21  8.32798e+05      1.24e-06
polygon 216              21  2.23023e+06      3.33e-06
polygon 217               8  6.30805e+05      9.42e-07
polygon 218              78  3.67603e+07      5.49e-05
polygon 219              18  1.64745e+06      2.46e-06
polygon 220              58  1.31747e+07      1.97e-05
polygon 221              94  1.16837e+07      1.74e-05
polygon 222              53  3.17801e+06      4.75e-06
polygon 223             137  8.46454e+06      1.26e-05
polygon 224              23  4.36507e+05      6.52e-07
polygon 225              27  9.72136e+05      1.45e-06
polygon 226              55  1.98854e+06      2.97e-06
polygon 227              48  1.02651e+07      1.53e-05
polygon 228              15  3.16153e+05      4.72e-07
polygon 229              22  8.93201e+05      1.33e-06
polygon 230              18  2.91538e+05      4.35e-07
polygon 231              59  3.70736e+06      5.54e-06
polygon 232              11  1.55205e+05      2.32e-07
polygon 233              14  1.87401e+05      2.80e-07
polygon 234              11  6.54128e+04      9.77e-08
polygon 235              11  8.64659e+04      1.29e-07
polygon 236              12  2.25129e+05      3.36e-07
polygon 237              30  2.72178e+06      4.06e-06
polygon 238 (hole)        3 -2.26252e+00     -3.38e-12
polygon 239             180  1.80314e+07      2.69e-05
polygon 240              14  4.01942e+05      6.00e-07
polygon 241             103  1.33467e+07      1.99e-05
polygon 242              14  2.07708e+05      3.10e-07
polygon 243              55  4.38623e+06      6.55e-06
polygon 244              41  4.69733e+06      7.01e-06
polygon 245              74  3.92633e+06      5.86e-06
polygon 246              31  2.79477e+06      4.17e-06
polygon 247              17  8.74607e+05      1.31e-06
polygon 248              26  4.50962e+05      6.73e-07
polygon 249              18  1.15065e+06      1.72e-06
polygon 250             164  1.48037e+07      2.21e-05
polygon 251              12  3.17290e+05      4.74e-07
polygon 252              69  2.59551e+07      3.88e-05
polygon 253              37  7.85963e+05      1.17e-06
polygon 254              14  3.37873e+05      5.05e-07
polygon 255              12  1.77980e+05      2.66e-07
polygon 256              21  6.46195e+05      9.65e-07
polygon 257              24  2.69998e+06      4.03e-06
polygon 258              30  1.00675e+06      1.50e-06
polygon 259              57  4.22747e+06      6.31e-06
polygon 260              23  8.63543e+05      1.29e-06
polygon 261              11  2.01925e+05      3.02e-07
polygon 262              95  2.88232e+07      4.30e-05
polygon 263             452  9.64208e+07      1.44e-04
polygon 264              77  1.72297e+07      2.57e-05
polygon 265              16  3.33522e+05      4.98e-07
polygon 266              19  6.82895e+05      1.02e-06
polygon 267              43  3.95062e+06      5.90e-06
polygon 268              29  1.00709e+06      1.50e-06
polygon 269              21  8.90014e+05      1.33e-06
polygon 270              22  7.93453e+05      1.18e-06
polygon 271              13  4.52813e+05      6.76e-07
polygon 272              30  1.49817e+06      2.24e-06
polygon 273              48  4.23996e+06      6.33e-06
polygon 274              37  1.20290e+06      1.80e-06
polygon 275              19  4.85805e+05      7.25e-07
polygon 276              46  2.18001e+06      3.26e-06
polygon 277               7  1.33723e+05      2.00e-07
polygon 278              54  1.82059e+07      2.72e-05
polygon 279              10  8.57866e+05      1.28e-06
polygon 280              14  1.98445e+05      2.96e-07
polygon 281              19  4.68357e+05      6.99e-07
polygon 282              52  8.57765e+06      1.28e-05
polygon 283              73  7.91998e+06      1.18e-05
polygon 284              23  8.19561e+06      1.22e-05
polygon 285              10  1.06594e+05      1.59e-07
polygon 286             169  1.39462e+07      2.08e-05
polygon 287              17  2.55915e+05      3.82e-07
polygon 288              12  1.81516e+05      2.71e-07
polygon 289              16  3.68509e+05      5.50e-07
polygon 290              12  1.24954e+05      1.87e-07
polygon 291            1012  4.61886e+08      6.90e-04
polygon 292              15  5.42647e+05      8.10e-07
polygon 293              12  5.53088e+05      8.26e-07
polygon 294              24  1.06455e+06      1.59e-06
polygon 295              14  3.17038e+05      4.73e-07
polygon 296              17  1.25559e+06      1.87e-06
polygon 297              16  1.92407e+06      2.87e-06
polygon 298              80  1.86306e+07      2.78e-05
polygon 299              11  6.83880e+04      1.02e-07
polygon 300             166  4.21470e+07      6.29e-05
polygon 301              22  1.36174e+06      2.03e-06
polygon 302              31  6.07363e+05      9.07e-07
polygon 303              10  1.27067e+05      1.90e-07
polygon 304             164  5.02951e+07      7.51e-05
polygon 305              17  1.20798e+06      1.80e-06
polygon 306              59  2.41720e+06      3.61e-06
polygon 307              12  2.52952e+05      3.78e-07
polygon 308              14  2.44407e+05      3.65e-07
polygon 309              43  4.89177e+06      7.30e-06
polygon 310              40  3.86642e+06      5.77e-06
polygon 311              23  4.59203e+05      6.86e-07
polygon 312              14  1.79442e+05      2.68e-07
polygon 313              13  1.61191e+05      2.41e-07
polygon 314              43  1.33365e+06      1.99e-06
polygon 315              75  1.20247e+07      1.80e-05
polygon 316              17  9.96466e+04      1.49e-07
polygon 317              22  1.60660e+06      2.40e-06
polygon 318             730  1.16983e+08      1.75e-04
polygon 319             129  7.87539e+06      1.18e-05
polygon 320              22  4.66256e+05      6.96e-07
polygon 321              19  5.44519e+05      8.13e-07
polygon 322              16  3.73911e+05      5.58e-07
polygon 323              88  3.47678e+07      5.19e-05
polygon 324              46  3.23711e+06      4.83e-06
polygon 325              47  9.17482e+05      1.37e-06
polygon 326              14  4.44869e+05      6.64e-07
polygon 327              43  1.29527e+06      1.93e-06
polygon 328              65  3.20974e+06      4.79e-06
polygon 329             306  1.83695e+07      2.74e-05
polygon 330              17  4.25486e+05      6.35e-07
polygon 331              29  1.08467e+06      1.62e-06
polygon 332              26  1.16602e+06      1.74e-06
polygon 333             135  4.90655e+06      7.33e-06
polygon 334              23  1.87723e+06      2.80e-06
polygon 335              21  7.02338e+05      1.05e-06
polygon 336              30  4.99970e+06      7.47e-06
polygon 337              21  7.71571e+05      1.15e-06
polygon 338              13  1.47832e+05      2.21e-07
polygon 339              26  3.17307e+06      4.74e-06
polygon 340              17  1.03642e+06      1.55e-06
polygon 341             100  8.74537e+06      1.31e-05
polygon 342              11  1.13950e+05      1.70e-07
polygon 343              26  8.27840e+05      1.24e-06
polygon 344              17  4.10882e+05      6.14e-07
polygon 345              13  1.49250e+05      2.23e-07
polygon 346              35  1.76408e+06      2.63e-06
polygon 347              15  2.03390e+05      3.04e-07
polygon 348              18  1.70982e+05      2.55e-07
polygon 349              32  7.98599e+06      1.19e-05
polygon 350              27  3.20839e+05      4.79e-07
polygon 351             539  1.17139e+08      1.75e-04
polygon 352              51  1.57614e+06      2.35e-06
polygon 353              19  3.60772e+05      5.39e-07
polygon 354              58  2.10060e+06      3.14e-06
polygon 355              13  1.70224e+05      2.54e-07
polygon 356              11  6.11736e+05      9.13e-07
polygon 357              35  5.26152e+06      7.86e-06
polygon 358              16  1.99371e+05      2.98e-07
polygon 359              14  4.48979e+05      6.70e-07
polygon 360              25  1.92913e+06      2.88e-06
polygon 361              16  4.26157e+05      6.36e-07
polygon 362              46  1.88229e+06      2.81e-06
polygon 363              17  2.29456e+05      3.43e-07
polygon 364              36  4.01418e+06      5.99e-06
polygon 365              57  1.77153e+07      2.65e-05
polygon 366              20  5.72298e+05      8.55e-07
polygon 367              14  2.46782e+05      3.68e-07
polygon 368              29  1.01300e+06      1.51e-06
polygon 369              90  8.54955e+06      1.28e-05
polygon 370              21  3.99098e+05      5.96e-07
polygon 371              12  2.81650e+05      4.21e-07
polygon 372              52  3.19337e+06      4.77e-06
polygon 373              13  3.40300e+05      5.08e-07
polygon 374              29  9.08533e+05      1.36e-06
polygon 375              20  3.07393e+05      4.59e-07
polygon 376              19  1.15906e+06      1.73e-06
polygon 377              17  1.16182e+06      1.73e-06
polygon 378              21  2.60877e+06      3.90e-06
polygon 379              15  1.09001e+05      1.63e-07
polygon 380              37  1.31921e+06      1.97e-06
polygon 381              53  1.46854e+06      2.19e-06
polygon 382              59  8.92822e+06      1.33e-05
polygon 383               9  7.44981e+04      1.11e-07
polygon 384              14  2.41462e+05      3.61e-07
polygon 385              96  7.25940e+06      1.08e-05
polygon 386              11  1.06055e+05      1.58e-07
polygon 387              49  1.87834e+06      2.80e-06
polygon 388              23  6.08310e+05      9.08e-07
polygon 389              50  6.76488e+05      1.01e-06
polygon 390              22  4.83089e+05      7.21e-07
polygon 391              17  1.17278e+05      1.75e-07
polygon 392              13  8.98786e+05      1.34e-06
polygon 393              43  1.01757e+06      1.52e-06
polygon 394              52  1.68377e+06      2.51e-06
polygon 395             348  2.50314e+08      3.74e-04
polygon 396              43  1.29120e+06      1.93e-06
polygon 397              71  2.02836e+06      3.03e-06
polygon 398 (hole)        4 -4.12791e+00     -6.16e-12
polygon 399             141  4.53240e+06      6.77e-06
polygon 400              52  3.62008e+06      5.41e-06
polygon 401              20  7.69539e+05      1.15e-06
polygon 402              88  8.88904e+06      1.33e-05
polygon 403              12  1.44668e+05      2.16e-07
polygon 404              46  2.28026e+06      3.40e-06
polygon 405              39  4.79165e+06      7.15e-06
polygon 406              53  2.86736e+06      4.28e-06
polygon 407              38  3.22508e+06      4.82e-06
polygon 408              18  4.44863e+05      6.64e-07
polygon 409              45  1.45134e+06      2.17e-06
polygon 410              86  2.56400e+07      3.83e-05
polygon 411             158  1.74510e+07      2.61e-05
polygon 412              14  2.50383e+05      3.74e-07
polygon 413             120  7.17019e+06      1.07e-05
polygon 414             146  2.28448e+07      3.41e-05
polygon 415             143  2.34472e+07      3.50e-05
polygon 416              20  3.47415e+05      5.19e-07
polygon 417              84  3.86387e+06      5.77e-06
polygon 418              68  1.10850e+07      1.66e-05
polygon 419             863  7.47702e+07      1.12e-04
polygon 420              53  7.54742e+06      1.13e-05
polygon 421              64  2.11016e+06      3.15e-06
polygon 422             103  1.47525e+07      2.20e-05
polygon 423              26  3.40345e+06      5.08e-06
polygon 424             103  8.40445e+06      1.25e-05
polygon 425              23  4.92041e+05      7.35e-07
polygon 426              27  5.53625e+05      8.27e-07
polygon 427              60  3.56102e+06      5.32e-06
polygon 428             151  1.51314e+07      2.26e-05
polygon 429             708  4.18129e+08      6.24e-04
polygon 430             120  1.32857e+07      1.98e-05
polygon 431             856  2.53898e+08      3.79e-04
polygon 432              13  2.47298e+05      3.69e-07
polygon 433              16  7.35754e+05      1.10e-06
polygon 434              21  5.31633e+05      7.94e-07
polygon 435              72  1.03185e+07      1.54e-05
polygon 436              38  1.34734e+06      2.01e-06
polygon 437               8  4.09489e+05      6.11e-07
polygon 438              17  2.46995e+05      3.69e-07
polygon 439              14  1.42285e+05      2.12e-07
polygon 440               9  1.56346e+05      2.33e-07
polygon 441              42  5.49581e+05      8.21e-07
polygon 442              59  1.15813e+06      1.73e-06
polygon 443              12  1.16845e+05      1.74e-07
polygon 444              11  6.00122e+04      8.96e-08
polygon 445              14  1.63465e+05      2.44e-07
polygon 446               8  4.73674e+04      7.07e-08
polygon 447              23  6.69330e+05      9.99e-07
polygon 448             144  6.48346e+06      9.68e-06
polygon 449              74  4.79923e+06      7.17e-06
polygon 450             116  1.02706e+07      1.53e-05
polygon 451              16  2.74005e+05      4.09e-07
polygon 452              97  4.72599e+06      7.06e-06
polygon 453              18  6.15583e+05      9.19e-07
polygon 454             146  1.38979e+07      2.08e-05
polygon 455              32  1.94516e+06      2.90e-06
polygon 456              26  9.81356e+05      1.47e-06
polygon 457              82  4.39797e+06      6.57e-06
polygon 458              33  9.36113e+05      1.40e-06
polygon 459              47  1.51844e+06      2.27e-06
polygon 460             196  2.32689e+07      3.47e-05
polygon 461              53  1.30069e+06      1.94e-06
polygon 462              70  1.00802e+07      1.51e-05
polygon 463              10  5.33870e+05      7.97e-07
polygon 464             211  2.73026e+07      4.08e-05
polygon 465              41  1.44141e+06      2.15e-06
polygon 466               9  5.20220e+05      7.77e-07
polygon 467             316  6.66808e+07      9.96e-05
polygon 468              17  7.48505e+05      1.12e-06
polygon 469              15  1.49799e+05      2.24e-07
polygon 470              24  4.99500e+05      7.46e-07
polygon 471              12  2.24463e+05      3.35e-07
polygon 472             100  1.06028e+07      1.58e-05
polygon 473              11  1.24267e+05      1.86e-07
polygon 474             143  1.89581e+07      2.83e-05
polygon 475              60  7.07802e+06      1.06e-05
polygon 476             124  1.23476e+07      1.84e-05
polygon 477              34  5.67625e+06      8.48e-06
polygon 478             797  1.86955e+08      2.79e-04
polygon 479              15  7.15891e+05      1.07e-06
polygon 480              20  1.61624e+06      2.41e-06
polygon 481              13  1.73955e+05      2.60e-07
polygon 482              60  2.42590e+06      3.62e-06
polygon 483              20  3.86365e+05      5.77e-07
polygon 484             213  3.69421e+07      5.52e-05
polygon 485              15  4.55574e+05      6.80e-07
polygon 486              35  1.56058e+06      2.33e-06
polygon 487              32  1.42419e+06      2.13e-06
polygon 488              68  2.30711e+06      3.44e-06
polygon 489             240  5.93935e+07      8.87e-05
polygon 490             145  1.58875e+07      2.37e-05
polygon 491              39  3.67239e+06      5.48e-06
polygon 492              54  3.84847e+06      5.75e-06
polygon 493              32  1.14073e+06      1.70e-06
polygon 494              18  3.58549e+05      5.35e-07
polygon 495              25  8.06470e+05      1.20e-06
polygon 496              15  2.67818e+05      4.00e-07
polygon 497              26  1.43681e+06      2.15e-06
polygon 498              18  3.10061e+05      4.63e-07
polygon 499              18  4.71644e+05      7.04e-07
polygon 500              16  5.04146e+05      7.53e-07
polygon 501              72  7.33720e+06      1.10e-05
polygon 502              27  1.37772e+06      2.06e-06
polygon 503              15  3.17217e+05      4.74e-07
polygon 504              37  1.17498e+06      1.75e-06
polygon 505              21  7.05388e+05      1.05e-06
polygon 506             216  2.05399e+07      3.07e-05
polygon 507              16  2.40093e+05      3.59e-07
polygon 508              29  1.71282e+06      2.56e-06
polygon 509              30  1.28695e+06      1.92e-06
polygon 510              36  2.29670e+06      3.43e-06
polygon 511             129  1.97698e+07      2.95e-05
polygon 512              65  2.65969e+06      3.97e-06
polygon 513             283  3.30575e+07      4.94e-05
polygon 514              28  7.06271e+05      1.05e-06
polygon 515              28  5.50158e+05      8.21e-07
polygon 516              49  2.25015e+06      3.36e-06
polygon 517              26  1.24280e+06      1.86e-06
polygon 518              28  9.02794e+05      1.35e-06
polygon 519              18  4.84064e+05      7.23e-07
polygon 520              47  2.33442e+06      3.49e-06
polygon 521              17  2.23835e+05      3.34e-07
polygon 522              34  7.32504e+05      1.09e-06
polygon 523              41  7.15538e+05      1.07e-06
polygon 524              21  5.81687e+05      8.69e-07
polygon 525              63  3.83819e+06      5.73e-06
polygon 526              27  1.33192e+06      1.99e-06
polygon 527              46  2.95028e+06      4.41e-06
polygon 528              10  1.34210e+05      2.00e-07
polygon 529              16  2.38274e+05      3.56e-07
polygon 530              18  4.18536e+05      6.25e-07
polygon 531              46  1.26584e+06      1.89e-06
polygon 532              14  2.14679e+05      3.21e-07
polygon 533              76  3.63371e+06      5.43e-06
polygon 534             339  4.44685e+07      6.64e-05
polygon 535             109  6.29786e+06      9.40e-06
polygon 536              14  2.89570e+05      4.32e-07
polygon 537              37  9.07704e+05      1.36e-06
polygon 538              68  3.86104e+06      5.77e-06
polygon 539             183  1.45458e+07      2.17e-05
polygon 540              44  1.64355e+06      2.45e-06
polygon 541              26  1.21667e+06      1.82e-06
polygon 542              13  1.95710e+05      2.92e-07
polygon 543              38  1.44402e+06      2.16e-06
polygon 544              14  3.29394e+05      4.92e-07
polygon 545              14  1.79828e+05      2.69e-07
polygon 546              44  2.11118e+06      3.15e-06
polygon 547             643  1.79215e+08      2.68e-04
polygon 548              24  1.10979e+06      1.66e-06
polygon 549              30  1.57106e+06      2.35e-06
polygon 550              46  3.61716e+06      5.40e-06
polygon 551              93  7.56340e+05      1.13e-06
polygon 552              57  3.07732e+06      4.59e-06
polygon 553              18  2.16224e+05      3.23e-07
polygon 554              17  5.12388e+05      7.65e-07
polygon 555               9  7.44780e+04      1.11e-07
polygon 556              57  8.09122e+06      1.21e-05
polygon 557              16  4.01323e+05      5.99e-07
polygon 558             118  2.90304e+07      4.33e-05
polygon 559              22  4.44693e+05      6.64e-07
polygon 560              43  2.28763e+06      3.42e-06
polygon 561              27  1.15444e+06      1.72e-06
polygon 562              25  1.21695e+06      1.82e-06
polygon 563              53  4.49228e+06      6.71e-06
enclosing rectangle: [-210008.6, 724647.6] x [1072026.3, 3158467.1] units
                     (934700 x 2086000 units)
Window area = 6.69714e+11 square units
Fraction of frame area: 0.343</code></pre>
</div>
</div>
<section id="plotting-armed-events-owin" class="level2">
<h2 class="anchored" data-anchor-id="plotting-armed-events-owin">Plotting Armed events owin:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(armed_q_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="plotting-stkde-for-quarterly-kde" class="level3">
<h3 class="anchored" data-anchor-id="plotting-stkde-for-quarterly-kde">Plotting stkde for quarterly kde</h3>
<p>We now do spatio-temporal KDE here with st_kde as it’ll provide the baseline for our later spatio-temporal visualizations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>st_kde <span class="ot">&lt;-</span> <span class="fu">spattemp.density</span>(armed_q_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating trivariate smooth...Done.
Edge-correcting...Done.
Conditioning on time...Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(st_kde)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatiotemporal Kernel Density Estimate

Bandwidths
  h = 45784.57 (spatial)
  lambda = 0.0047 (temporal)

No. of observations
  35606 

Spatial bound
  Type: polygonal
  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]

Temporal bound
  [1, 12]

Evaluation
  128 x 128 x 12 trivariate lattice
  Density range: [6.782504e-24, 1.543807e-10]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In my initial run, there were duplicate points. Since ACLED collects from a variety of sources, I have considered the possibility of multiple sources reporting the same event, but for sake of time I have jittered them earlier on. Below, we shall embark on plotting out the graph. Note that I decided on representation as 1-12 since tt only takes in numeric so quarter() from tidyverse would not work well with it…</p>
</div>
</div>
</section>
</section>
<section id="quarterly-kde" class="level2">
<h2 class="anchored" data-anchor-id="quarterly-kde">Quarterly KDE</h2>
<p>Let’s now move onto our quarterly KDE analysis, now that our kde and st_kde objects are set up in our environments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>kde <span class="ot">&lt;-</span> <span class="fu">density</span>(armed_q_owin,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kde)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>real-valued pixel image
128 x 128 pixel array (ny, nx)
enclosing rectangle: [-210008.6, 724647.6] x [1072026, 3158467] units
dimensions of each pixel: 7300 x 16300.32 units
Image is defined on a subset of the rectangular grid
Subset area = 669515348322.876 square units
Subset area fraction = 0.343
Pixel values (inside window):
    range = [-1.363178e-21, 6.712878e-06]
    integral = 34672
    mean = 5.178671e-08</code></pre>
</div>
</div>
<p>Here, we plot 3 quarters as a time for a compact side-by-side view of progression of conflict from a spatial standpoint.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot 3 quarters</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>plot_kde_quarters <span class="ot">&lt;-</span> <span class="cf">function</span>(start_quarter) {</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  quarters <span class="ot">&lt;-</span> start_quarter<span class="sc">:</span>(start_quarter <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> quarters) {</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(kde, i, </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">override.par=</span><span class="cn">FALSE</span>, </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">fix.range=</span><span class="cn">TRUE</span>, </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"KDE (non-spatial) Q"</span>, i, <span class="st">"("</span>, <span class="fu">floor</span>((i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">2021</span>), <span class="st">"Q"</span>, (i<span class="dv">-1</span>)<span class="sc">%%</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span>, <span class="st">")"</span>),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">ribbon=</span><span class="cn">TRUE</span>)  <span class="co"># Turned ribbon back on for more informative plots</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))  <span class="co"># Reset plot layout</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot 3 quarters</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>plot_kde_quarters <span class="ot">&lt;-</span> <span class="cf">function</span>(start_quarter) {</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  quarters <span class="ot">&lt;-</span> start_quarter<span class="sc">:</span>(start_quarter <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> quarters) {</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(kde, i, </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">override.par=</span><span class="cn">FALSE</span>, </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">fix.range=</span><span class="cn">TRUE</span>, </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"KDE (non-spatial) Q"</span>, i, <span class="st">"("</span>, <span class="fu">floor</span>((i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">2021</span>), <span class="st">"Q"</span>, (i<span class="dv">-1</span>)<span class="sc">%%</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span>, <span class="st">")"</span>),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">ribbon=</span><span class="cn">TRUE</span>)  <span class="co"># Turned ribbon back on for more informative plots</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))  <span class="co"># Reset plot layout</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now proceed to plot the non spatial temporal KDEs to visualize the distribution of events without time considered.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot four sets of quarters</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_kde_quarters</span>(<span class="dv">1</span>)  <span class="co"># Quarters 1, 2, 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_kde_quarters</span>(<span class="dv">4</span>)  <span class="co"># Quarters 4,5,6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_kde_quarters</span>(<span class="dv">7</span>)  <span class="co"># Quarters 7,8,9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_kde_quarters</span>(<span class="dv">10</span>) <span class="co"># Quarters 10,11,12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As we can see, there are some pin points of conflict in the central regions and south region of Myanmar, but nothing really conclusive. Thus, we fall back onto our spatio-temporal KDE for detailed analysis of the conflict. Let’s dive in!</p>
</section>
<section id="quarterly-spatiotemporal-kde" class="level2">
<h2 class="anchored" data-anchor-id="quarterly-spatiotemporal-kde">Quarterly spatiotemporal KDE</h2>
<p>This function ahead will help us chunk down and plot 3 side-by-side quarters:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot 3 quarters</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>plot_quarters <span class="ot">&lt;-</span> <span class="cf">function</span>(start_quarter) {</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  quarters <span class="ot">&lt;-</span> start_quarter<span class="sc">:</span>(start_quarter <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> quarters) {</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(st_kde, i, </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">override.par=</span><span class="cn">FALSE</span>, </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">fix.range=</span><span class="cn">TRUE</span>, </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"KDE Q"</span>, i, <span class="st">"("</span>, <span class="fu">floor</span>((i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">2021</span>), <span class="st">"Q"</span>, (i<span class="dv">-1</span>)<span class="sc">%%</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span>, <span class="st">")"</span>),</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">ribbon=</span><span class="cn">TRUE</span>)  <span class="co"># Turned ribbon back on for more informative plots</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))  <span class="co"># Reset plot layout</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot four sets of quarters</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_quarters</span>(<span class="dv">1</span>)  <span class="co"># Quarters 1, 2, 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_quarters</span>(<span class="dv">4</span>)  <span class="co"># Quarters 4, 5, 6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_quarters</span>(<span class="dv">7</span>)  <span class="co"># Quarters 7, 8, 9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_quarters</span>(<span class="dv">10</span>)  <span class="co"># Quarters 10, 11, 12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Wow! It’s now much clearer that our thesis of the hotspots being central and maybe south regions of Myanmar looks more viable now. Based on the charts, we can actually point out some interesting trends:</p>
<ol type="1">
<li><p>There’s been a large hotspot for conflict in central Vietnam, but there has been a sudden migration and flare up in conflict in 2023 Q4, spreading from Central Regions to the east too.</p></li>
<li><p>From 2023 Q1 onwards, the conflict really seems to have died down in the south region of Myanmar, with the exception of the sudden outburst again in 2023 Q4.</p></li>
</ol>
<p>Peeking outside of our data, we can see that this is probably linked to Operation 1027:</p>
<p><a href="https://thediplomat.com/2023/10/operation-1027-a-turning-point-for-myanmars-resistance-struggle/" class="uri">https://thediplomat.com/2023/10/operation-1027-a-turning-point-for-myanmars-resistance-struggle/</a></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
But what is Operation 1027?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Operation 1027 is an ongoing military offensive launched on October 27, 2023, by the Three Brotherhood Alliance (3BTA), which includes the Arakan Army (AA), Myanmar National Democratic Alliance Army (MNDAA), and Ta’ang National Liberation Army (TNLA). The operation targets the State Administration Council (SAC), Myanmar’s ruling military junta, and aims to capture strategic locations in northern Shan State, near the Myanmar-China border.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now let's animate this</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"animation"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"animation"</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(animation)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>plot_quarters_gif <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">output_file =</span> <span class="st">"kde_plot_animation.gif"</span>) {</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the animation</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveGIF</span>({</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Loop through 12 quarters</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) {</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Plot single quarter</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(st_kde, q, </span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">override.par =</span> <span class="cn">FALSE</span>, </span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">fix.range =</span> <span class="cn">TRUE</span>, </span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"KDE Q"</span>, q, <span class="st">"("</span>, <span class="fu">floor</span>((q<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">2021</span>), <span class="st">"Q"</span>, (q<span class="dv">-1</span>) <span class="sc">%%</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span>, <span class="st">")"</span>),</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">ribbon =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">movie.name =</span> output_file, <span class="at">interval =</span> <span class="fl">0.5</span>, <span class="at">ani.width =</span> <span class="dv">600</span>, <span class="at">ani.height =</span> <span class="dv">400</span>, <span class="at">loop =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the path to the created GIF</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output_file)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>gif_path <span class="ot">&lt;-</span> <span class="fu">plot_quarters_gif</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Output at: kde_plot_animation.gif</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print(paste("GIF created at:", gif_path))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"kde_plot_animation.gif"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kde_plot_animation.gif" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>As we can see, it seems like above Mandalay and below Sagaing there seems to be a hotspot of armed conflict events, with some initial conflict in Yangon in the earlier quarters. However, there seems to be a flare up in the conflict in the last quarter we have in the dataset. We should now dig deeper with 2nd order analysis in the highlighted areas. We’ll look at Mandalay as it’s the primary region of the conflict.</p>
</div>
</div>
</section>
<section id="second-order-analysis" class="level2">
<h2 class="anchored" data-anchor-id="second-order-analysis">Second order analysis</h2>
<p>We’ll load the regional shp file now and create an owin for it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>regional_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/regional"</span>, </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"mmr_polbnda2_adm1_250k_mimu_1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `mmr_polbnda2_adm1_250k_mimu_1' from data source 
  `C:\Users\yapho\Documents\SMU\smu y4\is415\hxyap_IS415\takehome\ex1\data\regional' 
  using driver `ESRI Shapefile'
Simple feature collection with 18 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(regional_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform Myanmar boundary to match ACLED data CRS</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>regional_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(regional_sf , <span class="fu">st_crs</span>(acled_sf))</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">st_crs</span>(regional_sf ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:32647 
  wkt:
PROJCRS["WGS 84 / UTM zone 47N",
    BASEGEOGCRS["WGS 84",
        ENSEMBLE["World Geodetic System 1984 ensemble",
            MEMBER["World Geodetic System 1984 (Transit)"],
            MEMBER["World Geodetic System 1984 (G730)"],
            MEMBER["World Geodetic System 1984 (G873)"],
            MEMBER["World Geodetic System 1984 (G1150)"],
            MEMBER["World Geodetic System 1984 (G1674)"],
            MEMBER["World Geodetic System 1984 (G1762)"],
            MEMBER["World Geodetic System 1984 (G2139)"],
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ENSEMBLEACCURACY[2.0]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4326]],
    CONVERSION["UTM zone 47N",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",0,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",99,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.9996,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",500000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",0,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Navigation and medium accuracy spatial referencing."],
        AREA["Between 96°E and 102°E, northern hemisphere between equator and 84°N, onshore and offshore. China. Indonesia. Laos. Malaysia - West Malaysia. Mongolia. Myanmar (Burma). Russian Federation. Thailand."],
        BBOX[0,96,84,102]],
    ID["EPSG",32647]]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create window for ppp objects</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>reg_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(regional_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Redefine the window of the jittered ppp object</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>armed_r_owin <span class="ot">&lt;-</span> acled_q_ppp_jit[reg_owin]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>conflict_r_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">as.data.frame</span>(acled_q_ppp_jit), <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="at">crs =</span> <span class="fu">st_crs</span>(regional_sf))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> regional_sf, <span class="fu">aes</span>(<span class="at">fill =</span> ST), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Use ST or any other column for filling</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> conflict_r_sf, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Armed Conflicts in Myanmar"</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"State/Region"</span>) <span class="sc">+</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Recalling our hotspot analysis, let’s find the hottest region.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note on commented out blocks
</div>
</div>
<div class="callout-body-container callout-body">
<p>Feel free to uncomment the below chunk! For the sake of not exploding my github repo, I’ve decided to cull memory usage by not running the below chunk, but if you run it, you should probably also see that it is centered by Mandalay :)</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the centroid of all conflict points</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># conflict_center &lt;- st_centroid(st_union(conflict_r_sf))</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the centroid to an sf object</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># conflict_center_sf &lt;- st_sf(geometry = conflict_center)</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure both objects have the same CRS</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># conflict_center_sf &lt;- st_transform(conflict_center_sf, st_crs(regional_sf))</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a spatial join to find which region contains the center point</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co"># center_region &lt;- st_join(conflict_center_sf, regional_sf)</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the region name (assuming the region column is named 'ST' as in your previous code)</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="co"># region_name &lt;- center_region$ST</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the coordinates</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print(paste("The center of the conflict points is in the region:", region_name))</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="co"># print(paste("The center of the conflict points is in the region:", region_name)</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#      X       Y</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="co"># [1,] 190741 2294623</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "The center of the conflict points is in the region: Mandalay"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="mandalay-analysis" class="level3">
<h3 class="anchored" data-anchor-id="mandalay-analysis">Mandalay analysis</h3>
<p>We’ll take a look at Mandalay here since we saw it as “hot” in our initial analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Subset the Mandalay region</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>Mandalay_sf <span class="ot">&lt;-</span> regional_sf[regional_sf<span class="sc">$</span>ST <span class="sc">==</span> <span class="st">"Mandalay"</span>, ]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create a window for Mandalay</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>Mandalay_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(Mandalay_sf)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Subset the point pattern to Mandalay</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>Mandalay_ppp <span class="ot">&lt;-</span> acled_q_ppp_jit[Mandalay_owin]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Mandalay_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern:  3064 points
Average intensity 9.884318e-08 points per square unit

Coordinates are given to 11 decimal places

marks are numeric, of type 'double'
Summary:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   4.000   6.000   6.628  10.000  12.000 

Window: polygonal boundary
single connected closed polygon with 5914 vertices
enclosing rectangle: [66291.97, 282396.46] x [2234807.4, 2622191.5] units
                     (216100 x 387400 units)
Window area = 30998600000 square units
Fraction of frame area: 0.37</code></pre>
</div>
</div>
<p>We’ll convert to km here using rescale, since previously, using the base unit (metres) had issues with plotting the second order functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>Mandalay_ppp_km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(Mandalay_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Mandalay_ppp_km)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We’ll first start by using the L function:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
L-function:
</div>
</div>
<div class="callout-body-container callout-body">
<p>The L function, a variant of Ripley’s K function, examines spatial dependence over a range of distances. It measures the number of points within increasing radii from each point, providing insight into patterns at multiple scales simultaneously.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>L_mw <span class="ot">=</span> <span class="fu">Lest</span>(Mandalay_ppp_km, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_mw, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># L_mw.csr &lt;- envelope(Mandalay_ppp_km, Lest, nsim = 99, rank = 1, glocal=TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(L_mw.csr, . - r ~ r, xlab="d", ylab="L(d)-r")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since our function fell outside our envelope, this means there’s a significant deviation from the Complete Spatial Randomness (CSR) at various distance scales, providing significant evidence of clustering at those distances. Let’s confirm this by backing it up with the G-function:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
G function
</div>
</div>
<div class="callout-body-container callout-body">
<p>The G function analyzes the distribution of distances to the nearest neighbor for each point in a spatial pattern. It focuses on first-order spatial effects, primarily capturing local, small-scale patterns.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>G_mw.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(Mandalay_ppp, Gest, <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 99 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,
61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 
99.

Done.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_mw.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"K(d)-r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Since our observed G function falls within the envelope, it suggests that the nearest neighbor distances in the observed pattern do not significantly differ from what would be expected under CSR at the local, first-order level.</p>
<p>Hmmm… Although the G-function is within our expected envelope, however, our L function is not. What does this mean? I think a reasonable take is that:</p>
<ul>
<li>At the very local scale (nearest neighbors), conflicts appear to be randomly distributed. This suggests no immediate spatial dependency between individual conflict events.</li>
</ul>
<!-- -->
<ul>
<li>However, at larger scales, there is significant clustering of conflicts. This indicates that while individual events might not be directly influencing each other’s locations, there are broader factors creating areas of higher conflict density.</li>
</ul>
<!-- -->
<ul>
<li>This pattern could be explained by the presence of “hot zones” of conflict activity. Within these zones, individual conflicts might occur in seemingly random locations, but the zones themselves represent areas of heightened risk or activity.</li>
</ul>
<p>Thus, I think the reasonable conclusion here is that even at the region level, perhaps due to the nature of resources/ locations being held by the different actors in the Myanmar civil conflict, the conflicts are “grouped” in hotspots, but within those hotspots, the reported location can vary, which suggests a structure to how either conflicts are reported in the region, or by what locations are important within a region, especially in a hotspot region like the Mandalay region.</p>
</section>
</section>
</section>
<section id="visualization-of-conflict-density-using-openstreetmap" class="level1">
<h1>Visualization of Conflict Density Using OpenStreetMap</h1>
<p>Now that we’ve had the basic analysis, let’s use OpenStreetMap to let us see in greater detail what’s going on. We use get_osm_map to get our basemap from OpenStreetMap, then do some CRS conversion as well as list making/raster conversion to stack our images to present a more nuanced graph!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to fetch OpenStreetMap base map</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>get_osm_map <span class="ot">&lt;-</span> <span class="cf">function</span>(bbox) {</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  osm_map <span class="ot">&lt;-</span> <span class="fu">read_osm</span>(bbox, <span class="at">type =</span> <span class="st">"osm"</span>, <span class="at">zoom =</span> <span class="cn">NULL</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(osm_map)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>plot_kde_quarters_tmap <span class="ot">&lt;-</span> <span class="cf">function</span>(kde, start_quarter) {</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  quarters <span class="ot">&lt;-</span> start_quarter<span class="sc">:</span>(start_quarter <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get bounding box from kde object</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  bbox_utm <span class="ot">&lt;-</span> <span class="fu">c</span>(kde<span class="sc">$</span>xrange[<span class="dv">1</span>], kde<span class="sc">$</span>yrange[<span class="dv">1</span>], kde<span class="sc">$</span>xrange[<span class="dv">2</span>], kde<span class="sc">$</span>yrange[<span class="dv">2</span>])</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a SpatialPolygons object for the bounding box</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  bbox_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(<span class="fu">extent</span>(bbox_utm), <span class="st">"SpatialPolygons"</span>)</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proj4string</span>(bbox_sp) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+proj=utm +zone=47 +datum=WGS84 +units=m +no_defs"</span>)</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transform bbox to WGS84</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>  bbox_wgs84 <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(bbox_sp) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="dv">4326</span>) <span class="sc">%&gt;%</span> <span class="fu">st_bbox</span>()</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fetch OpenStreetMap data</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>  osm_map <span class="ot">&lt;-</span> <span class="fu">get_osm_map</span>(bbox_wgs84)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a list to store individual plots</span></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>  plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> quarters) {</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert im object to a raster</span></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">raster</span>(kde)</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set the CRS for the raster</span></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">crs</span>(r) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+proj=utm +zone=47 +datum=WGS84 +units=m +no_defs"</span>)</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Project raster to WGS84</span></span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>    r_wgs84 <span class="ot">&lt;-</span> <span class="fu">projectRaster</span>(r, <span class="at">crs =</span> <span class="fu">CRS</span>(<span class="st">"+proj=longlat +datum=WGS84"</span>))</span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create tmap object</span></span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a>    tm <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(osm_map) <span class="sc">+</span></span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_rgb</span>() <span class="sc">+</span></span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_shape</span>(r_wgs84) <span class="sc">+</span></span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">"viridis"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">title =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"KDE Q"</span>, i, <span class="st">"("</span>, <span class="fu">floor</span>((i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">2021</span>), <span class="st">"Q"</span>, (i<span class="dv">-1</span>)<span class="sc">%%</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span>, <span class="st">")"</span>),</span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">main.title.size =</span> <span class="fl">0.8</span>,</span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.outside.position =</span> <span class="st">"right"</span>)</span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a>    plot_list[[i <span class="sc">-</span> start_quarter <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> tm</span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arrange plots in a row</span></span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_arrange</span>(plot_list, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_kde_quarters_tmap</span>(kde, <span class="at">start_quarter =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.2, 0.2, 0.2, 0.2, 0.2. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.2, 0.2, 0.2, 0.2, 0.2. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.
Legend labels were too wide. The labels have been resized to 0.2, 0.2, 0.2, 0.2, 0.2. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_kde_quarters_tmap</span>(kde, <span class="at">start_quarter =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.2, 0.2, 0.2, 0.2, 0.2. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.
Legend labels were too wide. The labels have been resized to 0.2, 0.2, 0.2, 0.2, 0.2. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.
Legend labels were too wide. The labels have been resized to 0.2, 0.2, 0.2, 0.2, 0.2. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_kde_quarters_tmap</span>(kde, <span class="at">start_quarter =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.2, 0.2, 0.2, 0.2, 0.2. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.
Legend labels were too wide. The labels have been resized to 0.2, 0.2, 0.2, 0.2, 0.2. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.
Legend labels were too wide. The labels have been resized to 0.2, 0.2, 0.2, 0.2, 0.2. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_kde_quarters_tmap</span>(kde, <span class="at">start_quarter =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.2, 0.2, 0.2, 0.2, 0.2. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.
Legend labels were too wide. The labels have been resized to 0.2, 0.2, 0.2, 0.2, 0.2. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.
Legend labels were too wide. The labels have been resized to 0.2, 0.2, 0.2, 0.2, 0.2. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This chunk is broken for now but should be fixed later :’)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage for static plots</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tmap_mode("plot")</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_stkde_quarters(st_kde, start_quarter = 1)</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage for animation</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_stkde_quarters(st_kde, animate = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bonus-section-network-analysis" class="level1">
<h1>Bonus section: Network analysis</h1>
<p>I’m starting this analysis to understand the complex dynamics of the Myanmar conflict, particularly focusing on Operation 1027 which began in October 2023. By looking at Q4 (which I assume is represented by QuarterNumeric == 12 in our data), I can capture the initial phase and immediate aftermath of this operation.</p>
<p>I’m using network analysis because conflicts often involve multiple actors with complex relationships. This method can help me visualize and quantify these relationships.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for Quarter 12</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>acled_q12 <span class="ot">&lt;-</span> acled_filtered <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(QuarterNumeric <span class="sc">==</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We first filter by Q12 (2023 Q4) to first look at Operation 1027 data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Network Graph of Actor Interactions</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>edge_list <span class="ot">&lt;-</span> acled_q12 <span class="sc">%&gt;%</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(actor1, actor2) <span class="sc">%&gt;%</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(actor1 <span class="sc">!=</span> <span class="st">""</span>, actor2 <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(actor1, actor2) <span class="sc">%&gt;%</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This step is about identifying interactions between actors. Each time two actors are involved in an event, it’s counted as an interaction. The ‘weight’ tells me how often these actors interacted.</p>
<p>In the context of Operation 1027, this could reveal new alliances or intensified conflicts between certain groups. For example, I might see increased interactions between the Three Brotherhood Alliance (who initiated Operation 1027) and the Myanmar military.</p>
</section>
<section id="network-graph-of-actor-interactions" class="level1">
<h1>Network Graph of Actor Interactions</h1>
<p>Now that we have our edge list, let’s create a pruned actor graph!</p>
<p>First, let’s make a directed graph from an edge list. In the context of conflict analysis, this represents interactions between actors, where the direction matters (e.g., who initiated an action against whom). Then, we’ll calculate the out-degree for each node (actor), which represents the number of actions initiated by each actor and select the top 10. This is crucial because:</p>
<ul>
<li><p>It identifies the most active conflict initiators</p></li>
<li><p>It allows us to focus on key players, simplifying a potentially complex network</p></li>
<li><p>It provides a quantitative measure of each actor’s role in driving the conflict</p></li>
</ul>
<p>Lastly, we’ll create a subgraph with those 10, to focus on their relationships and patterns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create graph</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(edge_list, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate node metrics, focusing on out-degree (initiations)</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>node_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">actor =</span> <span class="fu">V</span>(g)<span class="sc">$</span>name,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">initiations =</span> <span class="fu">degree</span>(g, <span class="at">mode =</span> <span class="st">"out"</span>)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(initiations)) <span class="sc">%&gt;%</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>)  <span class="co"># Focus on top 10 initiators</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create subgraph with top 10 initiators</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>top_actors <span class="ot">&lt;-</span> node_metrics<span class="sc">$</span>actor</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>g_sub <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(g, top_actors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to simplify actor names</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>simplify_name <span class="ot">&lt;-</span> <span class="cf">function</span>(name) {</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">str_detect</span>(name, <span class="st">":"</span>)) {</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">str_trim</span>(<span class="fu">str_split</span>(name, <span class="st">":"</span>, <span class="at">n =</span> <span class="dv">2</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]))</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(name)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the network visualization with simplified names</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>p_network <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(g_sub, <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width =</span> weight), </span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.2</span>, </span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>), <span class="at">type =</span> <span class="st">"closed"</span>)) <span class="sc">+</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="fu">degree</span>(g_sub, <span class="at">mode =</span> <span class="st">"out"</span>), </span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> <span class="fu">degree</span>(g_sub, <span class="at">mode =</span> <span class="st">"out"</span>))) <span class="sc">+</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sapply</span>(name, simplify_name)), </span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Initiators in Myanmar Conflict (October)"</span>,</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Node size and color: Number of initiated events</span><span class="sc">\n</span><span class="st">Edge width: Frequency of interactions"</span>,</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"Initiations"</span>, <span class="at">color =</span> <span class="st">"Initiations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Let’s print out our plot out right now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plot</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_network)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="takehome1_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of top initiators</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Top 10 Initiators in Myanmar Conflict (October):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 10 Initiators in Myanmar Conflict (October):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(node_metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                                                                              actor
Military Forces of Myanmar (2021-)                                                                               Military Forces of Myanmar (2021-)
Unidentified Armed Group (Myanmar)                                                                               Unidentified Armed Group (Myanmar)
PSLF/TNLA: Palaung State Liberation Front/Ta'ang National Liberation Army PSLF/TNLA: Palaung State Liberation Front/Ta'ang National Liberation Army
Police Forces of Myanmar (2021-)                                                                                   Police Forces of Myanmar (2021-)
Unidentified Anti-Coup Armed Group                                                                               Unidentified Anti-Coup Armed Group
Pyu Saw Htee                                                                                                                           Pyu Saw Htee
KIO/KIA: Kachin Independence Organization/Kachin Independence Army               KIO/KIA: Kachin Independence Organization/Kachin Independence Army
ULA/AA: United League of Arakan/Arakan Army                                                             ULA/AA: United League of Arakan/Arakan Army
Brotherhood Alliance                                                                                                           Brotherhood Alliance
GZP-Mandalay: Generation Z Power (Mandalay)                                                             GZP-Mandalay: Generation Z Power (Mandalay)
                                                                          initiations
Military Forces of Myanmar (2021-)                                                 55
Unidentified Armed Group (Myanmar)                                                 10
PSLF/TNLA: Palaung State Liberation Front/Ta'ang National Liberation Army           9
Police Forces of Myanmar (2021-)                                                    9
Unidentified Anti-Coup Armed Group                                                  6
Pyu Saw Htee                                                                        5
KIO/KIA: Kachin Independence Organization/Kachin Independence Army                  4
ULA/AA: United League of Arakan/Arakan Army                                         4
Brotherhood Alliance                                                                3
GZP-Mandalay: Generation Z Power (Mandalay)                                         3</code></pre>
</div>
</div>
<p>As we can see, the center of the visualization is the Brotherhood Alliance, represented by the largest node, indicating its role as the primary initiator of conflict events during this period. This aligns with reports of the Alliance spearheading a coordinated offensive against the military government.</p>
<p>Interesting, key ethnic armed organizations such as the United League of Arakan/Arakan Army (ULA/AA) and Kachin Independence Organization/Army (KIO/KIA) are prominently featured, highlighting the operation’s broad ethnic base. Their connections to the Brotherhood Alliance node visually represent the unprecedented level of coordination among these groups during the offensive.</p>
<p>The presence of nodes like “Unidentified Anti-Coup Armed Group” and “GZP-Mandalay” (Generation Z Power) also suggest involvement from pro-democracy forces and local resistance groups, indicating the diverse coalition that Operation 1027 has roped in to fight against the military.</p>
<p>Lastly, varying thicknesses of connecting lines between nodes depict the frequency of interactions. Notably, the thicker lines between the Brotherhood Alliance and other major groups corroborate reports of enhanced coordination, a factor that contributed to the operation’s initial success and the significant territorial gains made by resistance forces.</p>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
<p>Let’s quickly sum up some takeaways we’ve had from this:</p>
<ol type="1">
<li><p>Kernel Density Estimation (KDE): We used KDE to visualize the spatial intensity of conflict events across Myanmar. This method helped identify hotspots of conflict activity, revealing areas with higher concentrations of incidents. KDE provided a smoothed representation of event density, allowing us to discern broad patterns in the geographical distribution of conflicts.</p></li>
<li><p>Spatiotemporal KDE: By incorporating the temporal dimension into our KDE analysis, we examined how conflict hotspots evolved over time. This approach revealed the dynamic nature of the conflict, showing how areas of intense activity shifted or persisted across different periods. Spatiotemporal KDE helped us understand the conflict’s progression and identify potential seasonal or cyclical patterns in violence.</p></li>
<li><p>Second-order functions (L and G functions): These functions allowed us to analyze the spatial dependence and clustering of conflict events:</p></li>
<li><p>The G function focused on nearest neighbor distances, providing insights into local, small-scale patterns.</p></li>
<li><p>The L function examined spatial relationships across multiple scales, revealing broader clustering patterns.</p></li>
</ol>
<p>The combination of these functions showed that while conflicts might appear randomly distributed at very local scales, they exhibit significant clustering at larger scales. This suggests the presence of underlying factors influencing conflict distribution beyond immediate event-to-event interactions.</p>
<p>Network graphs for top 10 actors:</p>
<p>We constructed network graphs to visualize the relationships and interactions among the top 10 actors involved in the conflict. This approach helped us understand the complex web of alliances, confrontations, and power dynamics driving the conflict. By identifying key players and their connections, we gained insights into the conflict’s structure and potential points of influence or intervention.</p>
<p>By combining these analytical methods, we developed a comprehensive understanding of the Myanmar conflict:</p>
<ul>
<li><p>Spatial patterns: We identified key conflict hotspots and their evolution over time, providing a geographical context to the violence.</p></li>
<li><p>Multi-scale dynamics: Our analysis revealed how local randomness in event locations exists within larger-scale clustering, pointing to broader environmental or socio-political factors influencing conflict distribution.</p></li>
<li><p>Temporal trends: Spatiotemporal analysis helped us track the conflict’s progression and identify any cyclical patterns or significant shifts in activity.</p></li>
<li><p>Actor relationships: Network analysis of key players provided insights into the conflict’s human dimension, highlighting important relationships and power structures.</p></li>
</ul>
<p>Through this, I hope you’ve learnt along with me how R and geospatial analysis can really help deepen our understanding of such dire events like these, and gain a better more nuanced standpoint on what’s going on beyond what’s presented in the news, with potential for a complex and deep understanding on the groups to target/help to hopefully put to an end to such a tragic conflict for Myanmar and her people.</p>
<section id="acknowledgementsreferences" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgementsreferences">Acknowledgements/references</h2>
<ol type="1">
<li>Claude.ai <a href="https://claude.ai/new" class="uri">https://claude.ai/new</a></li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>